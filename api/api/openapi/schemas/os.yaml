---
# SPDX-FileCopyrightText: (C) 2025 Intel Corporation
# SPDX-License-Identifier: Apache-2.0

OperatingSystemType:
  description: "OsType describes the immutability of the OS.
    This field is immutable after creation."
  type: string
  format: enum
  enum:
    - OPERATING_SYSTEM_TYPE_UNSPECIFIED
    - OPERATING_SYSTEM_TYPE_MUTABLE
    - OPERATING_SYSTEM_TYPE_IMMUTABLE

OperatingSystemProvider:
  description: "Describes the OS owner that drives the OS provisioning."
  type: string
  format: enum
  enum:
    - OPERATING_SYSTEM_PROVIDER_UNSPECIFIED
    - OPERATING_SYSTEM_PROVIDER_INFRA
    - OPERATING_SYSTEM_PROVIDER_LENOVO

OperatingSystemResource:
  description: "An OS resource."
  type: object
  required:
    - updateSources
    - sha256
  properties:
    resourceId:
      type: string
      pattern: "^os-[0-9a-f]{8}$"
      description: "Resource ID, generated by inventory on Create"
      readOnly: true
    osResourceID:
      readOnly: true
      description: "The OS resource's unique identifier. Alias of resourceId."
      title: osResourceID
      type: string
      pattern: "^os-[0-9a-f]{8}$"
    name:
      description: "The OS resource's name."
      type: string
      maxLength: 128
      pattern: '^[a-zA-Z-_0-9. ()]+$'
    architecture:
      description: "The OS resource's architecture."
      title: "architecture"
      type: string
      pattern: '^$|^[a-zA-Z-_0-9./:;=@?!#,<>*()\"" ]+$'
      maxLength: 20
    kernelCommand:
      description: "The OS resource's kernel command."
      title: "kernelCommand"
      maxLength: 500
      type: string
      pattern: '^$|^[a-zA-Z-_0-9./:;=@?!#,<>*()\"" ]+$'
    updateSources:
      description: "The list of OS resource update sources."
      title: updateSources
      type: array
      maxItems: 100
      items:
        type: string
        pattern: '^$|^[a-zA-Z-_0-9./:;=@?!#,<>*+()\" \\\n]+$'
        maxLength: 10000
    repoUrl:
      deprecated: true  # Deprecating to rename it to imageUrl in 25.02
      description: "The URL repository of the OS update sources. Deprecated.
        Use imageUrl to filter repoUrl."
      title: repoUrl
      type: string
      pattern: '^$|^[a-zA-Z-_0-9./:;=@?!#,<>*()\"" ]+$'
      maxLength: 500
    imageUrl:
      description: "The URL repository of the OS image. If set, overwrites repoUrl."
      title: imageUrl
      type: string
      pattern: '^$|^[a-zA-Z-_0-9./:;=@?!#,<>*()\"" ]+$'
      maxLength: 500
    imageId:
      description: "A unique identifier of the OS image that can be retrieved from the running OS."
      title: imageId
      type: string
      pattern: '^$|^[a-zA-Z-_0-9./:;=@?!#,<>*()\"" ]+$'
    sha256:
      description: "SHA256 checksum of the OS resource in hexadecimal representation."
      type: string
      minLength: 64
      maxLength: 64
      pattern: '^[a-f0-9]+$'
    profileName:
      description: "Name of the OS profile that the OS resource belongs to."
      type: string
      maxLength: 128
      pattern: '^$|^[a-zA-Z-_0-9./:;=@?!#,<>*()\"" ]+$'
    profileVersion:
      description: "Version of OS profile that the OS resource belongs to."
      type: string
      readOnly: true
    installedPackages:
      # yamllint disable-line rule:line-length
      description: "Freeform text, OS-dependent. A list of package names, one per line (newline separated). Must not contain version information."
      title: installedPackages
      type: string
      pattern: '^$|^[a-zA-Z-_0-9./:;=@?!#,<>*()\" \\\n]+$'
    securityFeature:
      description: "Indicating if this OS is capable of supporting features like
        Secure Boot (SB) and Full Disk Encryption (FDE). Immutable after creation."
      "$ref": "./common.yaml#/SecurityFeature"
    osType:
      $ref: "#/OperatingSystemType"
    osProvider:
      $ref: "#/OperatingSystemProvider"
    platformBundle:
      # yamllint disable-line rule:line-length
      description: "Opaque JSON field storing references to custom installation script(s) that supplements the base OS with additional OS-level dependencies/configurations. If empty, the default OS installation will be used."
      type: string
      readOnly: true
    timestamps:
      "$ref": "./common.yaml#/Timestamps"
      readOnly: true
  title: OperatingSystemResource

OperatingSystemResourceList:
  description: "A list of OS resource objects."
  required:
    - OperatingSystemResources
    - hasNext
    - totalElements
  properties:
    OperatingSystemResources:
      type: array
      items:
        "$ref": "#/OperatingSystemResource"
      minItems: 0
      readOnly: true
    hasNext:
      description: "Indicates if there are more OS
        objects available to be retrieved."
      type: boolean
      readOnly: true
    totalElements:
      description: "Total number of items the request would return, if not limited by pagination."
      type: integer
      readOnly: true
  title: OperatingSystemResourceList
  type: object
