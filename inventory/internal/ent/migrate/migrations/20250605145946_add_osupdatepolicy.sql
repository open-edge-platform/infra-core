-- Create "os_update_policy_resources" table
CREATE TABLE "os_update_policy_resources" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY, "resource_id" character varying NOT NULL, "name" character varying NOT NULL, "description" character varying NULL, "install_packages" character varying NULL, "update_sources" character varying NULL, "kernel_command" character varying NULL, "update_policy" character varying NULL, "tenant_id" character varying NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL, "os_update_policy_resource_target_os" bigint NULL, PRIMARY KEY ("id"), CONSTRAINT "os_update_policy_resources_operating_system_resources_target_os" FOREIGN KEY ("os_update_policy_resource_target_os") REFERENCES "operating_system_resources" ("id") ON UPDATE NO ACTION ON DELETE SET NULL);
-- Create index "os_update_policy_resources_resource_id_key" to table: "os_update_policy_resources"
CREATE UNIQUE INDEX "os_update_policy_resources_resource_id_key" ON "os_update_policy_resources" ("resource_id");
-- Modify "instance_resources" table
ALTER TABLE "instance_resources" ADD COLUMN "instance_resource_os_update_policy" bigint NULL, ADD CONSTRAINT "instance_resources_os_update_policy_resources_os_update_policy" FOREIGN KEY ("instance_resource_os_update_policy") REFERENCES "os_update_policy_resources" ("id") ON UPDATE NO ACTION ON DELETE SET NULL;
-- Create "os_update_policies" table
CREATE TABLE "os_update_policies" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY, "resource_id" character varying NOT NULL, "installed_packages" character varying NULL, "update_sources" character varying NULL, "kernel_command" character varying NULL, "update_policy" character varying NULL, "tenant_id" character varying NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL, "os_update_policy_target_os" bigint NULL, PRIMARY KEY ("id"), CONSTRAINT "os_update_policies_operating_system_resources_target_os" FOREIGN KEY ("os_update_policy_target_os") REFERENCES "operating_system_resources" ("id") ON UPDATE NO ACTION ON DELETE SET NULL);
-- Create index "os_update_policies_resource_id_key" to table: "os_update_policies"
CREATE UNIQUE INDEX "os_update_policies_resource_id_key" ON "os_update_policies" ("resource_id");
